<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>replit</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
<style type="text/css">

.container{
   width: 400px;
   height: 225px;
   display: flex;
   justify-content: center;
   align-items: center;
   flex-direction: column;
   gap: 10px;
   border: 1px solid black;
}

.display_image_pos{
  position: fixed;
  left: 2%;
  top: 3%;
  padding: 5px;
}
  
.display_image{

   width: 500px;
   height: 700px;
   border: 1px solid black;
   
   background-position: center;

   background-size: cover;
   background-image: url("https://i.pinimg.com/originals/61/54/18/61541805b3069740ecd60d483741e5bb.jpg");
}

body{
  background: rgb(109, 112, 112);
}

.title{ /*Title text */
font-size: 25px;
position: fixed;
left: 40%;
top: 3%;


}

.titleinput{
  border: 2px groove black;
  width: 300px;
  height: 25px;
  padding: 10px;
  font-size: 20px;
}

.description{

  display:flex;
  flex-direction:column;
  position: fixed;
  left: 40%;
  top: 20%;
  font-size: 25px;
  padding: 10px;
}

.descriptionbox{
  border: 2px groove black;
  width: 500px;
  height: 300px;
  font-size: 20px;
}

.wordc{
  font-size: 20px;
  position:absolute;
  bottom:10px;
  right:15px;
}

.price{
  
  font-size: 25px;
  padding: 10px;
  position: fixed;
  right: 2%;
  top: 5%;
}


.priceinput{
  border: 2px groove black;
  width: 100px;
  height: 25px;
  padding: 10px;
  font-size: 20px;
}

.error{
  font-size: 20px;
  padding: 10px;
  position: fixed;
  right: 5%;
  top: 13%;
  color: red;
}

.cat {
  
  width: 150px;
  height: 75px;
  background-color: #2b7db4;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: 2px groove black;
  cursor: pointer;
}

.cat:hover, .cat:focus {
  background-color: #1f608b;
}

.catlabel{
  font-size: 25px;
  
}


.category {
  position: fixed;
  right: 2%;
  top: 25%;
}

.category-content {
  display: none;
  position: absolute;
  background-color: rgb(241, 13, 13);
  min-width: 160px;
  overflow: auto; 
}


.show {display: block;}

.submit{
  width: 150px;
  height: 75px;
  background-color: #2b7db4;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: 2px groove black;
  cursor: pointer;
  position: fixed;
  right: 2%;
  bottom: 15%;
}

  .submit:hover, .submit:focus {
  background-color: #1f608b;
}



</style >

<body>
  
<div class = "display_image_pos">
<input type="file" id ="image_input" name="uploadImage" accept="image/png,image/jpg">

<div class = "display_image" id="display_image" > </div>

</div>
<div class ="title">
  <label for="title">Title:</label>
  <input  class  = "titleinput" type="text" id="title" name="uploadTitle" required minlength="4" maxlength="16" size="16" placeholder="Max character length is 16..." ></input>
</div>

<div class ="description">
  <label  for="description">Description:</label>
  <textarea  id="description1" class ="descriptionbox"   name="uploadDescription" placeholder="Enter description of item..." ></textarea>
  <div class = "wordc" id="wordcount">0</div>
</div>



<div class ="price">
  <label for="price">Price:</label>
  <input  class = "priceinput" type="text" id="price" name="uploadPrice" required minlength="5" maxlength="9" size="10" placeholder="10.99"></input>
  
</div>

<div class = "error" id = "errorbox"></div>

<div class="category">
  <label class = "catlabel">Category:</label>
	<select class = "cat" id="category" name="uploadCategory">
		<option  value="Furniture">Furniture</option>
		<option value="Clothing">Clothing</option>
		<option value="Video Game">Video Game</option>
		<option value="Hardware">Hardware</option>
		<option value="Books">Books</option>
	</select>
</div>

<button class = "submit" id = submit name= "submit">Submit</button>


 


<script>


document.querySelector("#description1").addEventListener("input", function countWord() // source https://www.geeksforgeeks.org/how-to-make-a-word-count-in-textarea-using-javascript/
{
    let res = [];
    let str = this.value.replace(/[\t\n\r\.\?\!]/gm, " ").split(" ");
    str.map((s) => 
    {
      let trimStr = s.trim();
      if (trimStr.length > 0)
      {
          res.push(trimStr);
      }
    });
          document.querySelector("#wordcount").innerText = res.length;
});









let FileInput = document.getElementById("image_input");
let TitleInput = document.getElementById("title");
let DescriptionInput = document.getElementById("description");
let PriceInput = document.getElementById("price");
let CategoryInput = document.getElementById("category");

let button = document.getElementById("submit");

button.addEventListener("click", function() {
    
	console.log(uploaditem);

  //check if price is a float
 
  if (Number.isNaN(parseFloat(PriceInput)))
  {
    errorbox.textContent = "Not a valid Price";
    return;
  } 
  else
  {
    errorbox.textContent = "";
  }

  let uploaditem = {  //create upload item 
		//picture: FileInput.value, not sure how to upload picture
		title: TitleInput.value,
    description:  DescriptionInput.value,
    price: parseFloat(PriceInput.value),
    category: Category.value,
	}
  console.log(uploaditem);
	fetch("/upload", {
		method: "POST",
		headers: {
			"Content-Type": "application/json",
		},
    body: json.stringify(uploaditem),
	}).then(function (response) {
		console.log(response.status);
	}).catch(function (error) {
		console.log(error);
	});

});
	


//////code for image display element
const image_input = document.querySelector("#image_input"); //get image input
var image = "";
image_input.addEventListener("change", function()  
{
   const reader = new FileReader(); //use file reader object to read file
   reader.addEventListener("load", () => //add event listener load
   {
     image = reader.result; //set global variable to uploaded file in reader
     document.querySelector("#display_image").style.backgroundImage = `url(${image})`; //set display_image element to uploaded image 
    });
   reader.readAsDataURL(this.files[0]);
});
</script>

<script src="upload.js"></script>


</body>
</html>
